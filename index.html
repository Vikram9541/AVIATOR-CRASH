<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Crash Game Login</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <style>
    body { font-family: Arial, sans-serif; background: #111; color: white; padding: 20px; }
    .section { margin-bottom: 30px; border: 1px solid #444; padding: 20px; border-radius: 8px; }
    label, input, button { display: block; margin: 10px 0; }
    input, button { padding: 10px; width: 100%; max-width: 300px; }
    #dashboard { display: none; }
  </style>
</head>
<body><h1>üöÄ Crash Game Auth System</h1><div id="authSection" class="section">
  <button onclick="showSignUp()">First Time User</button>
  <button onclick="showLogin()">Already Have an Account</button>  <div id="signUpForm" style="display:none">
    <h3>Register</h3>
    <label>Name</label>
    <input id="signUpName" type="text">
    <label>Mobile</label>
    <input id="signUpMobile" type="text">
    <label>Password</label>
    <input id="signUpPass" type="password">
    <button onclick="registerUser()">Create Account</button>
  </div>  <div id="loginForm" style="display:none">
    <h3>Login</h3>
    <label>Mobile</label>
    <input id="loginMobile" type="text">
    <label>Password</label>
    <input id="loginPass" type="password">
    <button onclick="loginUser()">Login</button>
  </div>
</div><div id="dashboard" class="section">
  <h2>Welcome <span id="userName"></span></h2>
  <h3>Balance: ‚Çπ<span id="userBalance">0</span></h3>  <h3>üí∞ Deposit</h3>
  <label>Enter Amount</label>
  <input id="depositAmt" type="number">
  <label>UPI ID: <b>vikram95@kotak</b></label>
  <label>Enter UTR</label>
  <input id="depositUtr" type="text">
  <button onclick="submitDeposit()">Submit Deposit Request</button>
</div><script>
  const SUPABASE_URL = "https://angvxvuovzbfyxblogrv.supabase.co";
  const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFuZ3Z4dnVvdnpiZnl4YmxvZ3J2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI1ODM5OTMsImV4cCI6MjA2ODE1OTk5M30.qaUc04sIxTc_aD5nPDKrCr3MeaDSJB_cs1gnL8C1vKU";
  const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

  let currentUser = null;

  function showSignUp() {
    document.getElementById('signUpForm').style.display = 'block';
    document.getElementById('loginForm').style.display = 'none';
  }

  function showLogin() {
    document.getElementById('signUpForm').style.display = 'none';
    document.getElementById('loginForm').style.display = 'block';
  }

  async function registerUser() {
    const name = document.getElementById('signUpName').value;
    const mobile = document.getElementById('signUpMobile').value;
    const password = document.getElementById('signUpPass').value;

    const { data, error } = await supabase.from("users").insert([{ name, mobile, password, balance: 0 }]);
    if (error) return alert("‚ùå Error: " + error.message);
    alert("‚úÖ Account Created. Please login.");
    showLogin();
  }

  async function loginUser() {
    const mobile = document.getElementById('loginMobile').value;
    const password = document.getElementById('loginPass').value;

    const { data, error } = await supabase.from("users")
      .select("*")
      .eq("mobile", mobile)
      .eq("password", password)
      .maybeSingle();

    if (!data) return alert("‚ùå Invalid login");
    currentUser = data;
    document.getElementById("authSection").style.display = "none";
    document.getElementById("dashboard").style.display = "block";
    document.getElementById("userName").textContent = currentUser.name;
    document.getElementById("userBalance").textContent = currentUser.balance;
  }

  async function submitDeposit() {
    const amount = parseFloat(document.getElementById('depositAmt').value);
    const utr = document.getElementById('depositUtr').value;
    if (!amount || !utr) return alert("‚ùå Please fill amount and UTR");

    const { data, error } = await supabase.from("deposit_requests").insert([
      {
        mobile: currentUser.mobile,
        amount,
        utr,
        status: "pending"
      }
    ]);

    if (error) return alert("‚ùå Failed to submit: " + error.message);
    alert("‚úÖ Deposit request sent. Balance will be updated once approved.");
  }
</script></body>
</html>
