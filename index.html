<!DOCTYPE html><html>
<head>
  <title>Aviator Crash Game</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #000;
      color: white;
    }
    #auth-container {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    #login-btn {
      padding: 12px 20px;
      font-size: 18px;
      background: #4285F4;
      border: none;
      color: white;
      border-radius: 6px;
      cursor: pointer;
    }
    #game-ui {
      display: none;
      flex-direction: column;
      height: 100vh;
    }
    .top-bar {
      display: flex;
      justify-content: space-between;
      padding: 10px;
      background: #111;
    }
    .top-bar button {
      background: #333;
      border: none;
      padding: 8px 14px;
      border-radius: 6px;
      color: white;
      cursor: pointer;
    }
    .multiplier {
      text-align: center;
      font-size: 36px;
      margin: 20px 0;
    }
    .plane-area {
      flex: 1;
      display: flex;
      align-items: flex-end;
      justify-content: center;
      position: relative;
    }
    .plane-area img {
      width: 120px;
      position: absolute;
      bottom: 0;
    }
    .history {
      display: flex;
      justify-content: space-around;
      font-size: 20px;
      margin: 10px;
    }
    .bet-controls {
      display: flex;
      justify-content: space-around;
      align-items: center;
      background: #111;
      padding: 10px;
    }
    .bet-controls button {
      background: #444;
      border: none;
      padding: 8px 14px;
      border-radius: 6px;
      color: white;
      font-size: 18px;
    }
  </style>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getAuth, onAuthStateChanged, signInWithPopup, GoogleAuthProvider } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
    import { getDatabase, ref, set, get, update } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";const firebaseConfig = {
  apiKey: "AIzaSyAGn7jfjUuwHquYv0xEMWOo57kVm0EVzk8",
  authDomain: "aviator-crash-3fdcf.firebaseapp.com",
  databaseURL: "https://aviator-crash-3fdcf-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "aviator-crash-3fdcf",
  storageBucket: "aviator-crash-3fdcf.appspot.com",
  messagingSenderId: "181752775091",
  appId: "1:181752775091:web:d0ef4745359392a12f0bc6"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth();
const db = getDatabase();
const provider = new GoogleAuthProvider();

const loginBtn = document.getElementById('login-btn');
const authContainer = document.getElementById('auth-container');
const gameUI = document.getElementById('game-ui');
const planeImg = document.getElementById('plane');
const multiplierLabel = document.getElementById('multiplier');
const historyDiv = document.getElementById('history');
const balanceLabel = document.getElementById('balance');
const crashDataUrl = "assets/history_numbers.txt";

let user = null;
let crashIndex = 0;
let crashPoints = [];
let multiplier = 1.00;
let flyInterval;

fetch(crashDataUrl).then(r => r.text()).then(txt => {
  crashPoints = txt.trim().split('\n').map(v => parseFloat(v));
});

loginBtn.onclick = () => {
  signInWithPopup(auth, provider).catch(console.error);
};

onAuthStateChanged(auth, async (u) => {
  if (u) {
    user = u;
    authContainer.style.display = 'none';
    gameUI.style.display = 'flex';
    const balSnap = await get(ref(db, `users/${user.uid}/balance`));
    let bal = balSnap.exists() ? balSnap.val() : 0;
    balanceLabel.textContent = `Balance: ₹${bal}`;
    runGameLoop();
  }
});

function runGameLoop() {
  if (crashIndex >= crashPoints.length) crashIndex = 0;
  const crashAt = crashPoints[crashIndex++];
  multiplier = 1.00;
  multiplierLabel.textContent = multiplier.toFixed(2) + 'x';
  planeImg.style.bottom = '0';
  clearInterval(flyInterval);
  flyInterval = setInterval(() => {
    multiplier += 0.02;
    multiplierLabel.textContent = multiplier.toFixed(2) + 'x';
    if (multiplier >= crashAt) {
      clearInterval(flyInterval);
      historyDiv.innerHTML = `<div>${crashAt.toFixed(2)}x</div>` + historyDiv.innerHTML;
      setTimeout(runGameLoop, 3000);
    } else {
      planeImg.style.bottom = parseInt(planeImg.style.bottom || 0) + 2 + 'px';
    }
  }, 100);
}

  </script>
</head>
<body>
  <div id="auth-container">
    <button id="login-btn">Sign in with Google</button>
  </div>  <div id="game-ui">
    <div class="top-bar">
      <div id="balance">Balance: ₹0</div>
      <div>
        <button id="deposit-btn">Deposit</button>
        <button id="withdraw-btn">Withdraw</button>
      </div>
    </div>
    <div id="history" class="history"></div>
    <div class="multiplier" id="multiplier">1.00x</div>
    <div class="plane-area">
      <img src="assets/Flight.png" id="plane">
    </div>
    <div class="bet-controls">
      <button>- ₹25</button>
      <div>BET ₹25</div>
      <button>+ ₹25</button>
      <button>CASHOUT</button>
    </div>
  </div>
</body>
</html>
